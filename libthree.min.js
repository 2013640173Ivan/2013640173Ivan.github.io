// threejs.org/license
(function(k,Aa){"object"===typeof exports&&"undefined"!==typeof module?Aa(exports):"function"===typeof define&&define.amd?define(["exports"],Aa):Aa(k.THREE=k.THREE||{})})(this,function(k){function Aa(){}function C(a,b){this.x=a||0;this.y=b||0}function ba(a,b,c,d,e,f,g,h,l,m){Object.defineProperty(this,"id",{value:$e++});this.uuid=U.generateUUID();this.name="";this.image=void 0!==a?a:ba.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:ba.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:1001;this.wrapT=
void 0!==d?d:1001;this.magFilter=void 0!==e?e:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==l?l:1;this.format=void 0!==g?g:1023;this.type=void 0!==h?h:1009;this.offset=new C(0,0);this.repeat=new C(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==m?m:3E3;this.version=0;this.onUpdate=null}function ga(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1}function Db(a,b,c){this.uuid=U.generateUUID();this.width=
a;this.height=b;this.scissor=new ga(0,0,a,b);this.scissorTest=!1;this.viewport=new ga(0,0,a,b);c=c||{};void 0===c.minFilter&&(c.minFilter=1006);this.texture=new ba(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding);this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.depthTexture=void 0!==c.depthTexture?c.depthTexture:null}function Eb(a,b,c){Db.call(this,a,b,c);this.activeMipMapLevel=
this.activeCubeFace=0}function ha(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1}function q(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0}function J(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Za(a,b,c,d,e,f,g,h,l,m){a=void 0!==a?a:[];ba.call(this,a,void 0!==b?b:301,c,d,e,f,g,h,l,m);this.flipY=!1}function Fb(a,b,c){var d=a[0];if(0>=d||0<d)return a;
var e=b*c,f=te[e];void 0===f&&(f=new Float32Array(e),te[e]=f);if(0!==b)for(d.toArray(f,0),d=1,e=0;d!==b;++d)e+=c,a[d].toArray(f,e);return f}function ue(a,b){var c=ve[b];void 0===c&&(c=new Int32Array(b),ve[b]=c);for(var d=0;d!==b;++d)c[d]=a.allocTextureUnit();return c}function af(a,b){a.uniform1f(this.addr,b)}function bf(a,b){a.uniform1i(this.addr,b)}function cf(a,b){void 0===b.x?a.uniform2fv(this.addr,b):a.uniform2f(this.addr,b.x,b.y)}function df(a,b){void 0!==b.x?a.uniform3f(this.addr,b.x,b.y,b.z):
void 0!==b.r?a.uniform3f(this.addr,b.r,b.g,b.b):a.uniform3fv(this.addr,b)}function ef(a,b){void 0===b.x?a.uniform4fv(this.addr,b):a.uniform4f(this.addr,b.x,b.y,b.z,b.w)}function ff(a,b){a.uniformMatrix2fv(this.addr,!1,b.elements||b)}function gf(a,b){void 0===b.elements?a.uniformMatrix3fv(this.addr,!1,b):(we.set(b.elements),a.uniformMatrix3fv(this.addr,!1,we))}function hf(a,b){void 0===b.elements?a.uniformMatrix4fv(this.addr,!1,b):(xe.set(b.elements),a.uniformMatrix4fv(this.addr,!1,xe))}function jf(a,
b,c){var d=c.allocTextureUnit();a.uniform1i(this.addr,d);c.setTexture2D(b||ye,d)}function kf(a,b,c){var d=c.allocTextureUnit();a.uniform1i(this.addr,d);c.setTextureCube(b||ze,d)}function Ae(a,b){a.uniform2iv(this.addr,b)}function Be(a,b){a.uniform3iv(this.addr,b)}function Ce(a,b){a.uniform4iv(this.addr,b)}function lf(a){switch(a){case 5126:return af;case 35664:return cf;case 35665:return df;case 35666:return ef;case 35674:return ff;case 35675:return gf;case 35676:return hf;case 35678:return jf;case 35680:return kf;
case 5124:case 35670:return bf;case 35667:case 35671:return Ae;case 35668:case 35672:return Be;case 35669:case 35673:return Ce}}function mf(a,b){a.uniform1fv(this.addr,b)}function nf(a,b){a.uniform1iv(this.addr,b)}function of(a,b){a.uniform2fv(this.addr,Fb(b,this.size,2))}function pf(a,b){a.uniform3fv(this.addr,Fb(b,this.size,3))}function qf(a,b){a.uniform4fv(this.addr,Fb(b,this.size,4))}function rf(a,b){a.uniformMatrix2fv(this.addr,!1,Fb(b,this.size,4))}function sf(a,b){a.uniformMatrix3fv(this.addr,
!1,Fb(b,this.size,9))}function tf(a,b){a.uniformMatrix4fv(this.addr,!1,Fb(b,this.size,16))}function uf(a,b,c){var d=b.length,e=ue(c,d);a.uniform1iv(this.addr,e);for(a=0;a!==d;++a)c.setTexture2D(b[a]||ye,e[a])}function vf(a,b,c){var d=b.length,e=ue(c,d);a.uniform1iv(this.addr,e);for(a=0;a!==d;++a)c.setTextureCube(b[a]||ze,e[a])}function wf(a){switch(a){case 5126:return mf;case 35664:return of;case 35665:return pf;case 35666:return qf;case 35674:return rf;case 35675:return sf;case 35676:return tf;case 35678:return uf;
case 35680:return vf;case 5124:case 35670:return nf;case 35667:case 35671:return Ae;case 35668:case 35672:return Be;case 35669:case 35673:return Ce}}function xf(a,b,c){this.id=a;this.addr=c;this.setValue=lf(b.type)}function yf(a,b,c){this.id=a;this.addr=c;this.size=b.size;this.setValue=wf(b.type)}function De(a){this.id=a;this.seq=[];this.map={}}function $a(a,b,c){this.seq=[];this.map={};this.renderer=c;c=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(var d=0;d<c;++d){var e=a.getActiveUniform(b,d),
f=a.getUniformLocation(b,e.name),g=this,h=e.name,l=h.length;for(Od.lastIndex=0;;){var m=Od.exec(h),u=Od.lastIndex,p=m[1],n=m[3];"]"===m[2]&&(p|=0);if(void 0===n||"["===n&&u+2===l){h=g;e=void 0===n?new xf(p,e,f):new yf(p,e,f);h.seq.push(e);h.map[e.id]=e;break}else n=g.map[p],void 0===n&&(n=new De(p),p=g,g=n,p.seq.push(g),p.map[g.id]=g),g=n}}}function H(a,b,c){return void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}function db(a,b,c,d,e,f,g,h,l,m,u,p){ba.call(this,null,f,g,h,l,m,d,e,u,p);this.image=
{data:a,width:b,height:c};this.magFilter=void 0!==l?l:1003;this.minFilter=void 0!==m?m:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function id(a,b){this.min=void 0!==a?a:new C(Infinity,Infinity);this.max=void 0!==b?b:new C(-Infinity,-Infinity)}function zf(a,b){var c,d,e,f,g,h,l,m,u,p,n=a.context,r=a.state,k,t,A,x,z,G;this.render=function(v,L,P){if(0!==b.length){v=new q;var B=P.w/P.z,I=.5*P.z,Fa=.5*P.w,W=16/P.w,Ba=new C(W*B,W),ea=new q(1,1,0),eb=new C(1,1),Ma=new id;Ma.min.set(P.x,
P.y);Ma.max.set(P.x+(P.z-16),P.y+(P.w-16));if(void 0===x){var W=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),O=new Uint16Array([0,1,2,0,2,3]);k=n.createBuffer();t=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,k);n.bufferData(n.ARRAY_BUFFER,W,n.STATIC_DRAW);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t);n.bufferData(n.ELEMENT_ARRAY_BUFFER,O,n.STATIC_DRAW);z=n.createTexture();G=n.createTexture();r.bindTexture(n.TEXTURE_2D,z);n.texImage2D(n.TEXTURE_2D,0,n.RGB,16,16,0,n.RGB,n.UNSIGNED_BYTE,null);n.texParameteri(n.TEXTURE_2D,
n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);r.bindTexture(n.TEXTURE_2D,G);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,16,16,0,n.RGBA,n.UNSIGNED_BYTE,null);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);
n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);var W=A={vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},O=n.createProgram(),K=n.createShader(n.FRAGMENT_SHADER),
M=n.createShader(n.VERTEX_SHADER),R="precision "+a.getPrecision()+" float;\n";n.shaderSource(K,R+W.fragmentShader);n.shaderSource(M,R+W.vertexShader);n.compileShader(K);n.compileShader(M);n.attachShader(O,K);n.attachShader(O,M);n.linkProgram(O);x=O;u=n.getAttribLocation(x,"position");p=n.getAttribLocation(x,"uv");c=n.getUniformLocation(x,"renderType");d=n.getUniformLocation(x,"map");e=n.getUniformLocation(x,"occlusionMap");f=n.getUniformLocation(x,"opacity");g=n.getUniformLocation(x,"color");h=n.getUniformLocation(x,
"scale");l=n.getUniformLocation(x,"rotation");m=n.getUniformLocation(x,"screenPosition")}n.useProgram(x);r.initAttributes();r.enableAttribute(u);r.enableAttribute(p);r.disableUnusedAttributes();n.uniform1i(e,0);n.uniform1i(d,1);n.bindBuffer(n.ARRAY_BUFFER,k);n.vertexAttribPointer(u,2,n.FLOAT,!1,16,0);n.vertexAttribPointer(p,2,n.FLOAT,!1,16,8);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t);r.disable(n.CULL_FACE);r.setDepthWrite(!1);O=0;for(K=b.length;O<K;O++)if(W=16/P.w,Ba.set(W*B,W),M=b[O],v.set(M.matrixWorld.elements[12],
M.matrixWorld.elements[13],M.matrixWorld.elements[14]),v.applyMatrix4(L.matrixWorldInverse),v.applyMatrix4(L.projectionMatrix),ea.copy(v),eb.x=P.x+ea.x*I+I-8,eb.y=P.y+ea.y*Fa+Fa-8,!0===Ma.containsPoint(eb)){r.activeTexture(n.TEXTURE0);r.bindTexture(n.TEXTURE_2D,null);r.activeTexture(n.TEXTURE1);r.bindTexture(n.TEXTURE_2D,z);n.copyTexImage2D(n.TEXTURE_2D,0,n.RGB,eb.x,eb.y,16,16,0);n.uniform1i(c,0);n.uniform2f(h,Ba.x,Ba.y);n.uniform3f(m,ea.x,ea.y,ea.z);r.disable(n.BLEND);r.enable(n.DEPTH_TEST);n.drawElements(n.TRIANGLES,
6,n.UNSIGNED_SHORT,0);r.activeTexture(n.TEXTURE0);r.bindTexture(n.TEXTURE_2D,G);n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,eb.x,eb.y,16,16,0);n.uniform1i(c,1);r.disable(n.DEPTH_TEST);r.activeTexture(n.TEXTURE1);r.bindTexture(n.TEXTURE_2D,z);n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);M.positionScreen.copy(ea);M.customUpdateCallback?M.customUpdateCallback(M):M.updateLensFlares();n.uniform1i(c,2);r.enable(n.BLEND);for(var R=0,ca=M.lensFlares.length;R<ca;R++){var V=M.lensFlares[R];.001<V.opacity&&.001<
V.scale&&(ea.x=V.x,ea.y=V.y,ea.z=V.z,W=V.size*V.scale/P.w,Ba.x=W*B,Ba.y=W,n.uniform3f(m,ea.x,ea.y,ea.z),n.uniform2f(h,Ba.x,Ba.y),n.uniform1f(l,V.rotation),n.uniform1f(f,V.opacity),n.uniform3f(g,V.color.r,V.color.g,V.color.b),r.setBlending(V.blending,V.blendEquation,V.blendSrc,V.blendDst),a.setTexture2D(V.texture,1),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0))}}r.enable(n.CULL_FACE);r.enable(n.DEPTH_TEST);r.setDepthWrite(!0);a.resetGLState()}}}function Af(a,b){var c,d,e,f,g,h,l,m,u,p,n,r,k,t,
A,x,z;function G(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:b.id-a.id}var v=a.context,L=a.state,P,B,I,Fa,W=new q,Ba=new ha,ea=new q;this.render=function(q,Ma){if(0!==b.length){if(void 0===I){var O=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),K=new Uint16Array([0,1,2,0,2,3]);P=v.createBuffer();B=v.createBuffer();v.bindBuffer(v.ARRAY_BUFFER,P);v.bufferData(v.ARRAY_BUFFER,O,v.STATIC_DRAW);v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,B);v.bufferData(v.ELEMENT_ARRAY_BUFFER,
K,v.STATIC_DRAW);var O=v.createProgram(),K=v.createShader(v.VERTEX_SHADER),M=v.createShader(v.FRAGMENT_SHADER);v.shaderSource(K,["precision "+a.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
v.shaderSource(M,["precision "+a.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
v.compileShader(K);v.compileShader(M);v.attachShader(O,K);v.attachShader(O,M);v.linkProgram(O);I=O;x=v.getAttribLocation(I,"position");z=v.getAttribLocation(I,"uv");c=v.getUniformLocation(I,"uvOffset");d=v.getUniformLocation(I,"uvScale");e=v.getUniformLocation(I,"rotation");f=v.getUniformLocation(I,"scale");g=v.getUniformLocation(I,"color");h=v.getUniformLocation(I,"map");l=v.getUniformLocation(I,"opacity");m=v.getUniformLocation(I,"modelViewMatrix");u=v.getUniformLocation(I,"projectionMatrix");p=
v.getUniformLocation(I,"fogType");n=v.getUniformLocation(I,"fogDensity");r=v.getUniformLocation(I,"fogNear");k=v.getUniformLocation(I,"fogFar");t=v.getUniformLocation(I,"fogColor");A=v.getUniformLocation(I,"alphaTest");O=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");O.width=8;O.height=8;K=O.getContext("2d");K.fillStyle="white";K.fillRect(0,0,8,8);Fa=new ba(O);Fa.needsUpdate=!0}v.useProgram(I);L.initAttributes();L.enableAttribute(x);L.enableAttribute(z);L.disableUnusedAttributes();
L.disable(v.CULL_FACE);L.enable(v.BLEND);v.bindBuffer(v.ARRAY_BUFFER,P);v.vertexAttribPointer(x,2,v.FLOAT,!1,16,0);v.vertexAttribPointer(z,2,v.FLOAT,!1,16,8);v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,B);v.uniformMatrix4fv(u,!1,Ma.projectionMatrix.elements);L.activeTexture(v.TEXTURE0);v.uniform1i(h,0);K=O=0;(M=q.fog)?(v.uniform3f(t,M.color.r,M.color.g,M.color.b),M.isFog?(v.uniform1f(r,M.near),v.uniform1f(k,M.far),v.uniform1i(p,1),K=O=1):M.isFogExp2&&(v.uniform1f(n,M.density),v.uniform1i(p,2),K=O=2)):(v.uniform1i(p,
0),K=O=0);for(var M=0,R=b.length;M<R;M++){var ca=b[M];ca.modelViewMatrix.multiplyMatrices(Ma.matrixWorldInverse,ca.matrixWorld);ca.z=-ca.modelViewMatrix.elements[14]}b.sort(G);for(var V=[],M=0,R=b.length;M<R;M++){var ca=b[M],C=ca.material;!1!==C.visible&&(v.uniform1f(A,C.alphaTest),v.uniformMatrix4fv(m,!1,ca.modelViewMatrix.elements),ca.matrixWorld.decompose(W,Ba,ea),V[0]=ea.x,V[1]=ea.y,ca=0,q.fog&&C.fog&&(ca=K),O!==ca&&(v.uniform1i(p,ca),O=ca),null!==C.map?(v.uniform2f(c,C.map.offset.x,C.map.offset.y),
v.uniform2f(d,C.map.repeat.x,C.map.repeat.y)):(v.uniform2f(c,0,0),v.uniform2f(d,1,1)),v.uniform1f(l,C.opacity),v.uniform3f(g,C.color.r,C.color.g,C.color.b),v.uniform1f(e,C.rotation),v.uniform2fv(f,V),L.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),L.setDepthTest(C.depthTest),L.setDepthWrite(C.depthWrite),C.map?a.setTexture2D(C.map,0):a.setTexture2D(Fa,0),v.drawElements(v.TRIANGLES,6,v.UNSIGNED_SHORT,0))}L.enable(v.CULL_FACE);a.resetGLState()}}}function X(){Object.defineProperty(this,
"id",{value:Bf++});this.uuid=U.generateUUID();this.name="";this.type="Material";this.lights=this.fog=!0;this.blending=1;this.side=0;this.shading=2;this.vertexColors=0;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.colorWrite=!0;this.precision=null;this.polygonOffset=
!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.premultipliedAlpha=!1;this.overdraw=0;this._needsUpdate=this.visible=!0}function Ga(a){X.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=
this.morphTargets=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}function ab(a){X.call(this);this.type="MeshDepthMaterial";this.depthPacking=3200;this.morphTargets=!1;this.displacementMap=
this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a)}function Ua(a,b){this.min=void 0!==a?a:new q(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new q(-Infinity,-Infinity,-Infinity)}function Qa(a,b){this.center=void 0!==a?a:new q;this.radius=void 0!==b?b:0}function Ca(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}
function la(a,b){this.normal=void 0!==a?a:new q(1,0,0);this.constant=void 0!==b?b:0}function jd(a,b,c,d,e,f){this.planes=[void 0!==a?a:new la,void 0!==b?b:new la,void 0!==c?c:new la,void 0!==d?d:new la,void 0!==e?e:new la,void 0!==f?f:new la]}function Ee(a,b,c,d){function e(b,c,d,e){var f=b.geometry,g;g=t;var h=b.customDepthMaterial;d&&(g=A,h=b.customDistanceMaterial);h?g=h:(b=!1,c.morphTargets&&(f&&f.isBufferGeometry?b=f.morphAttributes&&f.morphAttributes.position&&0<f.morphAttributes.position.length:
f&&f.isGeometry&&(b=f.morphTargets&&0<f.morphTargets.length)),f=0,b&&(f|=1),g=g[f]);a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(h=g.uuid,f=c.uuid,b=x[h],void 0===b&&(b={},x[h]=b),h=b[f],void 0===h&&(h=g.clone(),b[f]=h),g=h);g.visible=c.visible;g.wireframe=c.wireframe;f=c.side;Fa.renderSingleSided&&2==f&&(f=0);Fa.renderReverseSided&&(0===f?f=1:1===f&&(f=0));g.side=f;g.clipShadows=c.clipShadows;g.clippingPlanes=c.clippingPlanes;g.wireframeLinewidth=c.wireframeLinewidth;
g.linewidth=c.linewidth;d&&void 0!==g.uniforms.lightPos&&g.uniforms.lightPos.value.copy(e);return g}function f(b,d,g,h){if(!1!==b.visible){if(0!==(b.layers.mask&d.layers.mask)&&(b.isMesh||b.isLine||b.isPoints)&&b.castShadow&&(!1===b.frustumCulled||!0===l.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(g.matrixWorldInverse,b.matrixWorld);var m=c.update(b),u=b.material;if(Array.isArray(u))for(var n=m.groups,p=0,r=n.length;p<r;p++){var z=n[p],t=u[z.materialIndex];t&&!0===t.visible&&(t=e(b,t,
h,k),a.renderBufferDirect(g,null,m,t,b,z))}else!0===u.visible&&(t=e(b,u,h,k),a.renderBufferDirect(g,null,m,t,b,null))}b=b.children;m=0;for(u=b.length;m<u;m++)f(b[m],d,g,h)}}var g=a.context,h=a.state,l=new jd,m=new J,u=b.shadows,p=new C,n=new C(d.maxTextureSize,d.maxTextureSize),r=new q,k=new q,t=Array(2),A=Array(2),x={},z=[new q(1,0,0),new q(-1,0,0),new q(0,0,1),new q(0,0,-1),new q(0,1,0),new q(0,-1,0)],G=[new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,1,0),new q(0,0,1),new q(0,0,-1)],v=[new ga,new ga,
new ga,new ga,new ga,new ga];b=new ab;b.depthPacking=3201;b.clipping=!0;d=bb.distanceRGBA;for(var L=Ia.clone(d.uniforms),P=0;2!==P;++P){var B=0!==(P&1),I=b.clone();I.morphTargets=B;t[P]=I;B=new Ga({defines:{USE_SHADOWMAP:""},uniforms:L,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,morphTargets:B,clipping:!0});A[P]=B}var Fa=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.renderSingleSided=this.renderReverseSided=!0;this.render=function(b,c){if(!1!==Fa.enabled&&
(!1!==Fa.autoUpdate||!1!==Fa.needsUpdate)&&0!==u.length){h.buffers.color.setClear(1,1,1,1);h.disable(g.BLEND);h.setDepthTest(!0);h.setScissorTest(!1);for(var d,e,t=0,q=u.length;t<q;t++){var A=u[t],B=A.shadow;if(void 0===B)console.warn("THREE.WebGLShadowMap:",A,"has no shadow.");else{var x=B.camera;p.copy(B.mapSize);p.min(n);if(A&&A.isPointLight){d=6;e=!0;var L=p.x,P=p.y;v[0].set(2*L,P,L,P);v[1].set(0,P,L,P);v[2].set(3*L,P,L,P);v[3].set(L,P,L,P);v[4].set(3*L,0,L,P);v[5].set(L,0,L,P);p.x*=4;p.y*=2}else d=
1,e=!1;null===B.map&&(B.map=new Db(p.x,p.y,{minFilter:1003,magFilter:1003,format:1023}),B.map.texture.name=A.name+".shadowMap",x.updateProjectionMatrix());B.isSpotLightShadow&&B.update(A);B&&B.isRectAreaLightShadow&&B.update(A);L=B.map;B=B.matrix;k.setFromMatrixPosition(A.matrixWorld);x.position.copy(k);a.setRenderTarget(L);a.clear();for(L=0;L<d;L++)e?(r.copy(x.position),r.add(z[L]),x.up.copy(G[L]),x.lookAt(r),h.viewport(v[L])):(r.setFromMatrixPosition(A.target.matrixWorld),x.lookAt(r)),x.updateMatrixWorld(),
x.matrixWorldInverse.getInverse(x.matrixWorld),B.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),B.multiply(x.projectionMatrix),B.multiply(x.matrixWorldInverse),m.multiplyMatrices(x.projectionMatrix,x.matrixWorldInverse),l.setFromMatrix(m),f(b,c,x,e)}}d=a.getClearColor();e=a.getClearAlpha();a.setClearColor(d,e);Fa.needsUpdate=!1}}}function fb(a,b){this.origin=void 0!==a?a:new q;this.direction=void 0!==b?b:new q}function cb(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||cb.DefaultOrder}
function Pd(){this.mask=1}function y(){Object.defineProperty(this,"id",{value:Cf++});this.uuid=U.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=y.DefaultUp.clone();var a=new q,b=new cb,c=new ha,d=new q(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,
value:d},modelViewMatrix:{value:new J},normalMatrix:{value:new Ca}});this.matrix=new J;this.matrixWorld=new J;this.matrixAutoUpdate=y.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new Pd;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={};this.onBeforeRender=function(){};this.onAfterRender=function(){}}function Gb(a,b){this.start=void 0!==a?a:new q;this.end=void 0!==b?b:new q}function Va(a,b,c){this.a=void 0!==a?a:new q;
this.b=void 0!==b?b:new q;this.c=void 0!==c?c:new q}function ua(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d&&d.isVector3?d:new q;this.vertexNormals=Array.isArray(d)?d:[];this.color=e&&e.isColor?e:new H;this.vertexColors=Array.isArray(e)?e:[];this.materialIndex=void 0!==f?f:0}function Ja(a){X.call(this);this.type="MeshBasicMaterial";this.color=new H(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=
null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.lights=this.morphTargets=!1;this.setValues(a)}function S(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=U.generateUUID();this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===c;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.onUploadCallback=
function(){};this.version=0}function sc(a,b){S.call(this,new Int8Array(a),b)}function tc(a,b){S.call(this,new Uint8Array(a),b)}function uc(a,b){S.call(this,new Uint8ClampedArray(a),b)}function vc(a,b){S.call(this,new Int16Array(a),b)}function gb(a,b){S.call(this,new Uint16Array(a),b)}function wc(a,b){S.call(this,new Int32Array(a),b)}function hb(a,b){S.call(this,new Uint32Array(a),b)}function D(a,b){S.call(this,new Float32Array(a),b)}function xc(a,b){S.call(this,new Float64Array(a),b)}function Fe(){this.indices=
[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function Qd(a){for(var b=a.length,c=-Infinity;b--;)a[b]>c&&(c=a[b]);return c}function T(){Object.defineProperty(this,"id",{value:Rd++});this.uuid=U.generateUUID();this.name="";this.type="Geometry";
this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function E(){Object.defineProperty(this,"id",{value:Rd++});this.uuid=U.generateUUID();this.name="";this.type="BufferGeometry";
this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}}function wa(a,b){y.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new E;this.material=void 0!==b?b:new Ja({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function Hb(a,b,c,d,e,f){T.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};this.fromBufferGeometry(new ib(a,
